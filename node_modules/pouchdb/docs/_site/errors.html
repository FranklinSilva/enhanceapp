<!DOCTYPE html>
<html lang="en" manifest="/manifest.appcache">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Common Errors</title>
    <link rel="alternate" title="PouchDB, the JavaScript Database that Syncs!" type="application/rss+xml" href="/feed.xml">
    <link rel="stylesheet" href="/static/css/pouchdb.css" />
    <meta name="theme-color" content="#6ccb99">
    <meta name="msapplication-TileColor" content="#6ccb99">
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-42479701-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <link href='http://fonts.googleapis.com/css?family=Lato:400,700|Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon"/>
  </head>

  <body data-spy="scroll" data-target="#sidebar">

    <header>

      <a href="https://github.com/pouchdb/pouchdb" target="_blank">
         <div class="ribbon">GitHub</div>
      </a>

      <div class="container">

        <a class="logo" href="/">
          <div class="logo-img"></div>
          <span class='logo-type'>PouchDB</span>
        </a>

        <ul class='nav nav-header nav-pills'>
          <li>
            <a class='btn btn-link btn-lg' href="/blog/">Blog</a>
          </li>
          <li>
            <a class='btn btn-link btn-lg' href="/guides/">Guides</a>
          </li>
          <li>
            <a class='btn btn-link btn-lg' href="/api.html">API</a>
          </li>
          <li>
            <a class='btn btn-link btn-lg' href="/learn.html">Learn</a>
          </li>
          <li>
            <a
                class='btn btn-primary btn-lg'
                href="https://github.com/pouchdb/pouchdb/releases/download/3.5.0/pouchdb-3.5.0.min.js"
            >
                Download <strong>v3.5.0</strong>
            </a>
          </li>
        </ul>

      </div>

    </header>
    
      <div class="page-head">

        <div class="container">

          <h1>Common Errors</h1>
          

        </div>

      </div>
    


    <article>
  <div class="container">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
          <div data-spy="affix" data-offset-top="214" data-offset-bottom="450">
            <ul class="nav nav-silent nav-sidebar">
              <li >
    <a href="/learn.html">About PouchDB</a>
</li>

<li >
    <a href="/users.html">Who's using PouchDB?</a>
</li>

<li >
    <a href="/getting-started.html">Get Started Guide</a>
</li>

<li >
    <a href="/api.html">API</a>
</li>

<li >
    <a href="/adapters.html">Adapters</a>
</li>

<li >
    <a href="/external.html">Plugins</a>
</li>

<li >
    <a href="/faq.html">FAQ</a>
</li>

<li  class="active" >
    <a href="/errors.html">Common Errors</a>
</li>


            </ul>
          </div>
        </div>

        <div class="col-sm-9">
          <div id='no_access_control_allow_origin_header'></div>

<p><a class='h3 anchor' href='#no_access_control_allow_origin_header' name='no_access_control_allow_origin_header'>No &#39;Access-Control-Allow-Origin&#39; header</a></p>

<p>If you see the error:</p>

<blockquote>
<p>XMLHttpRequest cannot load [...]
No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource.
Origin [...] is therefore not allowed access.</p>
</blockquote>

<p>or this one:</p>

<blockquote>
<p>Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at http://[couchDBIP]:[couchDBPort]/[dbname]/?_nonce=[request hash]. This can be fixed by moving the resource to the same domain or enabling CORS</p>
</blockquote>

<p>it&#39;s because you need to enable <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">CORS</a> on CouchDB/IrisCouch/whatever you&#39;re using. Otherwise, your scripts can only access the server database if they&#39;re served from the same origin &#8212; the protocol (ex: <em>http://</em>, <em>https://</em>), domain, and port number must match.</p>

<p>You can enable CORS in CouchDB using <code>curl</code> or the Futon web interface, but we&#39;ve saved you some time by making a Node script called <a href="https://github.com/pouchdb/add-cors-to-couchdb">add-cors-to-couchdb</a>. Just run:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>npm install -g add-cors-to-couchdb
<span class="nv">$ </span>add-cors-to-couchdb</code></pre></div>

<p>Or if your database is not at <code>127.0.0.1:5984</code>:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>add-cors-to-couchdb http://me.iriscouch.com <span class="se">\</span>
    -u myusername -p mypassword</code></pre></div>

<p>You can check that CORS is now enabled by visiting <a href="http://localhost:5984/_utils/config.html">http://localhost:5984/_utils/config.html</a> in your browser. You should see something like this:</p>

<p><a href="/static/img/cors_in_couchdb.png" target="_blank">
  <img class="img-responsive"  src="/static/img/cors_in_couchdb.png" alt="CORS settings in CouchDB" />
</a></p>

<div id='no_valid_adapter'></div>

<p><a class='h3 anchor' href='#no_valid_adapter' name='no_valid_adapter'>PouchDB throws a <code>No valid adapter found</code> error</a></p>

<p>Reading from/writing to a local database from an <code>iframe</code> with a different origin will cause PouchDB to throw a <code>No valid adapter found</code> error in Firefox. This is due to Firefox&#39;s IndexedDB implementation.</p>

<p>IndexedDB has a same-origin restriction. Read/write operations from another origin will always fail, but only Firefox triggers a <code>No valid adapter found</code> error. Chrome / Opera will instead throw an <a href="#unknown_error_chrome"><code>UnknownError</code></a>.</p>

<div id='not_enough_space'></div>

<p><a class='h3 anchor' href='#not_enough_space' name='not_enough_space'>iOS/Safari: &quot;there was not enough remaining storage space&quot;</a></p>

<p>On iOS and Safari, if you expect your app to use more than 5MB of space, you will need to request the space up-front from the user.  In certain versions, notably Safari/iOS 7, you can never request more than what the user originally grants you.</p>

<p><a href="/static/img/safari_popup.png" target="_blank">
  <img class="img-responsive"  src="/static/img/safari_popup.png" alt="Safari storage quota popup" />
</a></p>

<p>To get around this, when you create your PouchDB, use the <code>opts.size</code> option for the expected <em>maximum</em> size of the database in MB.  Valid increments are 10, 50, 100, 500, and 1000.  For instance, if you request 50, then Safari will show a popup saying &quot;allow 50MB?&quot; but if you request 51, then Safari will show a popup saying &quot;allow 100MB?&quot;.</p>

<p>If you don&#39;t use the <code>size</code> option, then you&#39;ll be able to use up to 5MB without any popup, but then once you use more, there will be a popup asking for 10.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">new</span> <span class="nx">PouchDB</span><span class="p">(</span><span class="s1">&#39;mydb&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">size</span><span class="o">:</span> <span class="mi">10</span><span class="p">});</span> <span class="c1">// request 10 MB with a popup</span>
<span class="k">new</span> <span class="nx">PouchDB</span><span class="p">(</span><span class="s1">&#39;mydb&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">size</span><span class="o">:</span> <span class="mi">50</span><span class="p">});</span> <span class="c1">// request 50 MB with a popup</span>
<span class="k">new</span> <span class="nx">PouchDB</span><span class="p">(</span><span class="s1">&#39;mydb&#39;</span><span class="p">);</span> <span class="c1">// implicitly request 5 MB, no popup until you exceed 5MB</span>
</code></pre></div>
<p>This does not affect any backend other than Web SQL. Chrome, Android, and Opera do not show the popup. On PhoneGap/Cordova apps, you can also use the <a href="https://github.com/brodysoft/Cordova-SQLitePlugin">SQLite plugin</a> to get around this problem. Here&#39;s <a href="http://www.html5rocks.com/en/tutorials/offline/quota-research">more information about storage quotas</a> and <a href="https://github.com/pouchdb/pouchdb/issues/2347">details on the Safari/iOS 7 bug</a>.</p>

<div id='404__local_document'></div>

<p><a class='h3 anchor' href='#404__local_document' name='404__local_document'>PouchDB throws 404 (Object Not Found) for &#39;_local&#39; document</a></p>

<p>Don&#39;t worry, nothing is amiss, this is expected behaviour:
During PouchDB&#39;s initial replication PouchDB will check for a checkpoint, if it doesn&#39;t exist a 404 will be returned and a checkpoint will subsequently be written.</p>

<div id='throwing_invalidstateerror'></div>

<p><a class='h3 anchor' href='#throwing_invalidstateerror' name='throwing_invalidstateerror'>PouchDB is throwing <code>InvalidStateError</code></a></p>

<p>Are you in private browsing mode? IndexedDB is <a href="https://developer.mozilla.org/en-US/docs/IndexedDB/Using_IndexedDB">disabled in private browsing mode</a> in Firefox.</p>

<div id='phonegap_cordova_second_database'></div>

<p><a class='h3 anchor' href='#phonegap_cordova_second_database' name='phonegap_cordova_second_database'>Can&#39;t open second database on Android WebView with Cordova/Phone Gap</a></p>

<p>There is a limit of one database per app in some versions of the Android WebView. Install the <a href="https://github.com/brodysoft/Cordova-SQLitePlugin">SQLite plugin</a>, then PouchDB will use that if it is available.</p>

<div id='size_limitation_5mb'></div>

<p><a class='h3 anchor' href='#size_limitation_5mb' name='size_limitation_5mb'>Database size limitation of ~5MB on iOS with Cordova/Phone Gap</a></p>

<p>If you&#39;re storing large amounts of data, such as PNG attachments, the <a href="https://github.com/brodysoft/Cordova-SQLitePlugin">SQLite plugin</a> is again your friend. (See <a href="https://github.com/pouchdb/pouchdb/issues/1260">issue #1260</a> for details.)</p>

<div id='404_get_couchapp'></div>

<p><a class='h3 anchor' href='#404_get_couchapp' name='404_get_couchapp'>CouchDB returns a 404 for GETs from a CouchApp</a></p>

<p>Certain URL rewrites are broken by PouchDB&#39;s cache-busting; try adding <code>{cache : false}</code> to the PouchDB constructor. (See <a href="https://github.com/pouchdb/pouchdb/issues/1233">issue #1233</a> for details.)</p>

<div id='typeerror_object_is_not_a_function'></div>

<p><a class='h3 anchor' href='#typeerror_object_is_not_a_function' name='typeerror_object_is_not_a_function'>Uncaught TypeError: object is not a function</a></p>

<p>Did you include the <a href="https://github.com/jakearchibald/es6-promise">es6-promise shim library</a>?  Not every browser implements ES6 Promises correctly. (See <a href="https://github.com/pouchdb/pouchdb/issues/1747">issue #1747</a> for details.)</p>

<div id='undefined_is_not_a_function'></div>

<p><a class='h3 anchor' href='#undefined_is_not_a_function' name='undefined_is_not_a_function'>Uncaught TypeError: &#39;undefined&#39; is not a function</a></p>

<p>Did you include the <a href="https://github.com/es-shims/es5-shim">es5-shim library</a>? In particular this shows up in PhantomJS because of <a href="https://github.com/ariya/phantomjs/issues/10522">this bug</a>.</p>

<div id='cordova_android_parse_error'></div>

<p><a class='h3 anchor' href='#cordova_android_parse_error' name='cordova_android_parse_error'>SyntaxError: Parse error (Cordova on Android)</a></p>

<p>Did you include the <a href="https://github.com/es-shims/es5-shim">es5-shim library</a>?  PouchDB is written in ES5, which is supported by modern browsers, but requires shims for older browsers (e.g. IE 9, Android 2.1 WebView).</p>

<p>In Android, if you&#39;re loading PouchDB directly via <code>webView.loadUrl(&#39;javascript://&#39; + js&#39;)</code>, you should prefer the minified PouchDB javascript file to the unminified one, since code comments can also cause parse errors.</p>

<div id='safari_object_silent_fail'></div>

<p><a class='h3 anchor' href='#safari_object_silent_fail' name='safari_object_silent_fail'>PouchDB object fails silently (Safari)</a></p>

<p>Safari requires users to confirm that they want to allow an app to store data locally (&quot;Allow this website to use space on your disk?&quot;).  If PouchDB is loaded in an <code>iframe</code> or some other unusual way, the dialog might not be shown, and the database will silently fail.</p>

<div id='window_localstorage_chrome_apps'></div>

<p><a class='h3 anchor' href='#window_localstorage_chrome_apps' name='window_localstorage_chrome_apps'>window.localStorage is not available (Chrome apps)</a></p>

<p>In Chrome apps, you&#39;ll see the warning &quot;window.localStorage is not available in packaged apps. Use chrome.storage.local instead.&quot;  This is harmless; since PouchDB doesn&#39;t use localStorage if it&#39;s not available.</p>

<div id='unknown_error_ff'></div>

<p><a class='h3 anchor' href='#unknown_error_ff' name='unknown_error_ff'>Error: UnknownError (Firefox)</a></p>

<p>Are you using a webserver to host and run your code? This error can be caused by running your script/file locally using the <code>file:///</code> setting in Firefox, since Firefox does not <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=643318">allow access to IndexedDB locally</a>. You can use the SimpleHTTPServer to deploy your script by running <code>python -m SimpleHTTPServer</code> from the directory containing the script, or use the Apache webserver and then access the script by using <code>http://localhost/{path_to_your_script}</code>.</p>

<div id='unknown_error_chrome'></div>

<p><a class='h3 anchor' href='#unknown_error_chrome' name='unknown_error_chrome'>Error: UnknownError (Chrome / Opera)</a></p>

<p>This can occur when attempting to read from or write to IndexedDB from a different origin. IndexedDB has a same-origin restriction. Attempting to write to the database associated with <em>http://example.com</em> from an <code>iframe</code> served from <em>http://api.example.com</em>, for example, will fail.</p>

<p>In Firefox, PouchDB instead throws a <a href="#no_valid_adapter"><code>No valid adapter found</code></a> error.</p>

<div id='could_not_be_cloned'></div>

<p><a class='h3 anchor' href='#could_not_be_cloned' name='could_not_be_cloned'>DataCloneError: An object could not be cloned</a></p>

<p>If you ever see:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Uncaught DataCloneError:
  Failed to execute &#39;put&#39; on &#39;IDBObjectStore&#39;:
  An object could not be cloned.
</code></pre></div>
<p>Or:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">DataCloneError: The object could not be cloned.
</code></pre></div>
<p>Then the problem is that the document you are trying to store is not a pure JSON object. For example, an object with its own class (<code>new Foo()</code>) or with special methods like getters and setters cannot be stored in PouchDB/CouchDB.</p>

<p>If you are ever unsure, then run this on the document:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">myDocument</span><span class="p">));</span>
</code></pre></div>
<p>If the object you get out is the same as the object you put in, then you are storing the right kind of object.</p>

<p>Note that this also means that you cannot store <code>Date</code>s in your document. You must convert them to strings or numbers first. <code>Date</code>s will be stored as-is in IndexedDB, but in the other adapters and in CouchDB, they will be automatically converted to ISO string format, e.g. <code>&#39;2015-01-01T12:00:00.000Z&#39;</code>. This can caused unwanted results. See <a href="https://github.com/pouchdb/pouchdb/issues/2351">#2351</a> and <a href="https://github.com/pouchdb/pouchdb/issues/2158">#2158</a> for details.</p>

<div id='android_pre_kitkat'></div>

<p><a class='h3 anchor' href='#android_pre_kitkat' name='android_pre_kitkat'>DOM Exception 18 in Android pre-Kitkat WebView</a></p>

<p>This applies to hybrid apps designed to run in Android pre-Kitkat (i.e. before 4.4).</p>

<p>If you are directly using a <code>WebView</code> and not using Cordova/PhoneGap, you will probably either run into an error where PouchDB silently fails or you see <code>Error: SECURITY_ERR: DOM Exception 18</code> in the console. As a sanity test, you can run this JavaScript:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">openDatabase</span><span class="p">(</span><span class="s1">&#39;mydatabase&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;mydatabase&#39;</span><span class="p">,</span> <span class="mi">5000000</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">db</span><span class="p">)</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;it works!&#39;</span><span class="p">);</span> <span class="p">});</span>
</code></pre></div>
<p>If you see &quot;it works&quot; in the console, then everything&#39;s peachy. Otherwise there are a few things you have to do.</p>

<p>First, make sure Web SQL is enabled on your <code>WebView</code> in the first place using <a href="http://developer.android.com/reference/android/webkit/WebSettings.html#setDatabaseEnabled%28boolean%29">setDatabaseEnabled</a>:</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">myWebView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setDatabaseEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</code></pre></div>
<p>Second, specify a path for the database. Yes, you need to do this, even though it&#39;s deprecated in Kitkat:</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">databasePath</span> <span class="o">=</span> <span class="n">getContext</span><span class="o">().</span><span class="na">getApplicationContext</span><span class="o">().</span><span class="na">getDir</span><span class="o">(</span>
  <span class="s">&quot;database&quot;</span><span class="o">,</span> <span class="n">Context</span><span class="o">.</span><span class="na">MODE_PRIVATE</span><span class="o">).</span><span class="na">getPath</span><span class="o">();</span>
<span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setDatabasePath</span><span class="o">(</span><span class="n">databasePath</span><span class="o">);</span>
</code></pre></div>
<p>Third, you&#39;ll need to set an <code>onExceededDatabaseQuota</code> handler. Yes, it&#39;s also deprecated in Kitkat. Yes, you still need to do it.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">webView</span><span class="o">.</span><span class="na">setWebChromeClient</span><span class="o">(</span><span class="k">new</span> <span class="nf">WebChromeClient</span><span class="o">()</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onExceededDatabaseQuota</span><span class="o">(</span><span class="n">String</span> <span class="n">url</span><span class="o">,</span> <span class="n">String</span> <span class="n">databaseIdentifier</span><span class="o">,</span> <span class="kt">long</span> <span class="n">currentQuota</span><span class="o">,</span> <span class="kt">long</span> <span class="n">estimatedSize</span><span class="o">,</span>
                                      <span class="kt">long</span> <span class="n">totalUsedQuota</span><span class="o">,</span> <span class="n">WebStorage</span><span class="o">.</span><span class="na">QuotaUpdater</span> <span class="n">quotaUpdater</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">quotaUpdater</span><span class="o">.</span><span class="na">updateQuota</span><span class="o">(</span><span class="n">estimatedSize</span> <span class="o">*</span> <span class="mi">2</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">});</span>
</code></pre></div>
<p>If you skip any one of these three steps, then you will get the <code>DOM Exception 18</code> error. You need to do all three.</p>

<p>Alternatively, you can also load the <code>WebView</code> with a fake <code>http://</code> URL, but this may cause other errors when you try to fetch files based on a relative path:</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">webView</span><span class="o">.</span><span class="na">loadDataWithBaseURL</span><span class="o">(</span><span class="s">&quot;http://www.example.com&quot;</span><span class="o">,</span>
    <span class="n">htmlContent</span><span class="o">,</span>
    <span class="s">&quot;text/html&quot;</span><span class="o">,</span>
    <span class="s">&quot;utf-8&quot;</span><span class="o">,</span>
    <span class="kc">null</span><span class="o">);</span>
</code></pre></div>
<div id='windows_leveldown'></div>

<p><a class='h3 anchor' href='#windows_leveldown' name='windows_leveldown'>PouchDB on Windows</a></p>

<p>It is known that building/compiling Node modules with native code on Windows can be frustrating, as there are lots of required dependencies to be installed, which may take many Gigabytes, as opossed to Unix platforms, where compiling is a breeze. Installing PouchDB on Node for Windows gave many headaches, specifically with the leveldown dep.</p>

<p>Since v3.2.1 leveldown was changed to be an <em>optional dependency</em>: this way, npm will not refuse installing PouchDB even when having compiling errors. That way, you can use PouchDB normally, and will get an error only when trying to use leveldown as the backend. To avoid that, you can specify any compatible adapter, as pointed in the <a href="/adapters.html#pouchdb_in_node_js">Adapters</a> section.</p>

<p>For example, if you want a SQLite backend, you can install:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install sqlite3
npm install sqldown</code></pre></div>

<p>and then use PouchDB with:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PouchDB</span><span class="p">(</span><span class="s1">&#39;database&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">db</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sqldown&#39;</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>
<p>Also, you have the option to use <a href="https://github.com/mafintosh/leveldown-prebuilt">leveldown-prebuilt</a>, which avoids native leveldown building when installing. Then for use leveldown-prebuilt as backend, you can install:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install leveldown-prebuilt</code></pre></div>

<p>and instance your PouchDB like this:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PouchDB</span><span class="p">(</span><span class="s1">&#39;database&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">db</span><span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;leveldown-prebuilt&#39;</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>
<div id='replicating_attachments_slow'></div>

<p><a class='h3 anchor' href='#replicating_attachments_slow' name='replicating_attachments_slow'>Replication with attachments is slow or fails</a></p>

<p>The symptoms for this issues are:</p>

<ol>
<li>Replicating a database that has many attachments from a CouchDB server is either slow or fails randomly.</li>
<li>You get server error message of the nature <code>No buffer space available</code>.</li>
</ol>

<p>Chances are that your server runs inside a virtual machine. The host system, or hypervisor, imposes limits on how much data each virtual machine can use for networking. If you are on a cheap virtual server, it is possible, that the default settings for PouchDB pull-replication (10 parallel batches of 100 documents each) exhaust the narrow limit of your server. Even a single client can cause this.</p>

<p>The solution is to move to a better server, but if that is not an immediate option, a workaround would be reducing the <code>options.batch_size</code> and <code>options.batches_limit</code> <a href="http://pouchdb.com/api.html#replication">replication options</a>.</p>

<p>To find optimal values, start by setting them both to 1 (meaning that PouchDB should download one document after the other) and increase from there and stop when the symptoms begin again. Note that multiple concurrent clients can still cause an issue, if you get too many. If all your documents have one or more attachments (e.g. a photos database), setting both options to <code>1</code> is probably a good idea.</p>

<div class="alert alert-info">


<div class="alert-text">


Generally, reducing these options that replicating the database down will take more time. Please test various settings to see what works for you and your hardware.

</div></div>

<div class="alert alert-info">


<div class="alert-text">


This issue has been found on OpenVZ systems, but other Hypervisors might also be affected. See
<a
  href="http://blog.aplikacja.info/2010/01/105-no-buffer-space-available-on-openvz-vps/"
  target="_blank"
>http://blog.aplikacja.info/2010/01/105-no-buffer-space-available-on-openvz-vps/</a>
on how to diagnose this issue.

</div></div>

        <div>

    </div>

  </div>

</article>


    <div class="icons">

      <div class="container">

        <div class="row">

          <div class='col-xs-4 col-md-offset-0 col-md-2'>
            <a href='https://twitter.com/pouchdb' target='_blank'>
              <div class="icon icon-twitter"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='https://github.com/rvagg/node-levelup' target='_blank'>
              <div class="icon icon-leveldb"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='https://github.com/pouchdb/pouchdb' target='_blank'>
              <div class="icon icon-github"></div>
            </a>
            </div>

          <div class='col-xs-4 col-md-offset-0 col-md-2'>
            <a href='https://travis-ci.org/pouchdb/pouchdb' target='_blank'>
              <div class="icon icon-travis"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='http://couchdb.apache.org/' target='_blank'>
              <div class="icon icon-couchdb"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='https://saucelabs.com' target='_blank'>
              <div class="icon icon-saucelabs"></div>
            </a>
          </div>

        </div>

      </div>

    </div>

    <footer class="footer">

      <div class="container">

        <div class="row">

          <div class='col-sm-3'>
            <h3 class="nav-head">Learn</h3>
            <ul class='nav nav-silent'>
              <li><a href="/getting-started.html">Getting Started</a></li>
              <li><a href="/api.html">API Guide</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb/wiki">Wiki</a></li>
            </ul>
          </div>

          <div class='col-sm-3'>
            <h3 class="nav-head">Discuss</h3>
            <ul class='nav nav-silent'>
              <li><a href="https://groups.google.com/forum/#!forum/pouchdb">Mailing List</a></li>
              <li><a href="irc://freenode.net/#pouchdb">IRC</a></li>
              <li><a href="http://twitter.com/pouchdb">Twitter</a></li>
              <li><a href="http://stackoverflow.com/questions/tagged/pouchdb">StackOverflow</a></li>
            </ul>
          </div>

          <div class='col-sm-3'>
            <h3 class="nav-head">Contribute</h3>
            <ul class='nav nav-silent'>
              <li><a href="https://github.com/pouchdb/pouchdb/blob/master/CONTRIBUTING.md">Contributing</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb">Source</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb/issues">Issues</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb/blob/master/LICENSE">Apache License</a></li>
            </ul>
          </div>

        </div>

      </div>

    </footer>
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/js/code.min.js"></script>
    <script type="text/javascript" src="http://cdn.jsdelivr.net/pouchdb/latest/pouchdb.min.js"></script>
    <script type="text/javascript">
      function onCached(e) {
        if (applicationCache.status === 1) {
          giveIntro();
        }
      }
      
      function giveIntro() {
        console.log('%c\n..............................................................................\n.?I...........~+: ............................................................\n.???.........++++.............................................................\n:????+......+++++.............................................................\n.??????+++++++++:.................................H...........D..B............\n...????++++++++...................................H...........D..B............\n...=????++++++.......PPPPP...OOOO...U....U...CCCC.HHHHH...DDDDD..BBBBB........\n...?????+++++++......P...:P.OO...O..U....U..C.....H...H..D....D..B....B.......\n..???????+++++++ ....P. ..P.O....O..U....U.CC.....H...H..D....D..B....B.......\n..?????????????......P...:P.OO...O..U....U..C.....H...H..D....D..B....B.......\n...I??????????~......PPPPP...OOOO...=UUUUU...CCCC.H...H...DDDDD..BBBBB........\n....?????????~.......P.... ...................................................\n.....???????+........P........................................................\n......??????..................................................................\n..............................................................................\n..............................................................................\n..............................................................................', 'color: #4ec084');
        console.log('%c\nPouchDB itself is hosted at PouchDB.com!\nTo get started, try typing:\nvar db = new PouchDB(\'mydb\');', 'color: #4ec084');
      }
      applicationCache.addEventListener('cached', onCached, false);
      applicationCache.addEventListener('noupdate', giveIntro, false);
    </script>
  </body>
</html>

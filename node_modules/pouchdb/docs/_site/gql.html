<!DOCTYPE html>
<html lang="en" manifest="/manifest.appcache">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GQL Documentation</title>
    <link rel="alternate" title="PouchDB, the JavaScript Database that Syncs!" type="application/rss+xml" href="/feed.xml">
    <link rel="stylesheet" href="/static/css/pouchdb.css" />
    <meta name="theme-color" content="#6ccb99">
    <meta name="msapplication-TileColor" content="#6ccb99">
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-42479701-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <link href='http://fonts.googleapis.com/css?family=Lato:400,700|Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon"/>
  </head>

  <body data-spy="scroll" data-target="#sidebar">

    <header>

      <a href="https://github.com/pouchdb/pouchdb" target="_blank">
         <div class="ribbon">GitHub</div>
      </a>

      <div class="container">

        <a class="logo" href="/">
          <div class="logo-img"></div>
          <span class='logo-type'>PouchDB</span>
        </a>

        <ul class='nav nav-header nav-pills'>
          <li>
            <a class='btn btn-link btn-lg' href="/blog/">Blog</a>
          </li>
          <li>
            <a class='btn btn-link btn-lg' href="/guides/">Guides</a>
          </li>
          <li>
            <a class='btn btn-link btn-lg' href="/api.html">API</a>
          </li>
          <li>
            <a class='btn btn-link btn-lg' href="/learn.html">Learn</a>
          </li>
          <li>
            <a
                class='btn btn-primary btn-lg'
                href="https://github.com/pouchdb/pouchdb/releases/download/3.5.0/pouchdb-3.5.0.min.js"
            >
                Download <strong>v3.5.0</strong>
            </a>
          </li>
        </ul>

      </div>

    </header>
    
      <div class="page-head">

        <div class="container">

          <h1>GQL Documentation</h1>
          

        </div>

      </div>
    


    <article>
  <div class="container">
    <div class="row">
        <div id="sidebar" class="col-sm-3">
          <div data-spy="affix" data-offset-top="214" data-offset-bottom="450">
            <ul class="nav nav-silent nav-sidebar">
              <li >
    <a href="/learn.html">About PouchDB</a>
</li>

<li >
    <a href="/users.html">Who's using PouchDB?</a>
</li>

<li >
    <a href="/getting-started.html">Get Started Guide</a>
</li>

<li >
    <a href="/api.html">API</a>
</li>

<li >
    <a href="/adapters.html">Adapters</a>
</li>

<li >
    <a href="/external.html">Plugins</a>
</li>

<li >
    <a href="/faq.html">FAQ</a>
</li>

<li >
    <a href="/errors.html">Common Errors</a>
</li>


            </ul>
          </div>
        </div>

        <div class="col-sm-9">
          <p>The Google Query Language (GQL) interface provides an alternative method for accessing data.
The version of GQL implemented here is based on the Google Visualization API Query Language
(https://developers.google.com/chart/interactive/docs/querylanguage).
The syntax of GQL queries should be familiar to those who have used SQL,
but the capabilities of GQL are much more limited.</p>

<p>GQL queries are performed by passing a query object to the gql method along with a callback.
Callbacks are in the node.js idiom of <code>function(err, data)</code> Where the first argument will be undefined
unless there is an error, and further arguments specify the result.
Note that only identifiers and string literals are case-sensitive.</p>

<h3>Language Syntax</h3>

<ul>
<li><a href="#select">Select</a></li>
<li><a href="#where">Where</a></li>
<li><a href="#groupBy">Group By</a></li>
<li><a href="#pivot">Pivot</a></li>
<li><a href="#label">Label</a></li>
<li><a href="#functions">Functions</a>

<ul>
<li><a href="#aggregation_functions">Aggregation Functions</a></li>
<li><a href="#scalar_functions">Scalar Functions</a></li>
<li><a href="#arithmetic_operators">Arithmetic Operators</a></li>
</ul></li>
<li><a href="#miscellaneous">Miscellaneous</a>

<ul>
<li><a href="#literals">Literals</a></li>
<li><a href="#identifiers">Identifiers</a></li>
<li><a href="#reserved_words">Reserved Words</a></li>
</ul></li>
</ul>

<h2>Perform a Query</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.gql(query, [options], [callback])
</code></pre></div>
<p>Although only the query is mandatory, the callback is required to access the query result.
Currently no query options are implemented.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var pouchdb;
PouchDB(&#39;idb://test&#39;, function(err, db) {
   pouchdb = db;
  // Use pouchdb to call further functions
    db.gql({select: &quot;*&quot;, where: &quot;type=&#39;Fire&#39; and name is not null&quot;}, function(err, result){
        if(!err){
        // Use the results of the query here
        }
      }
})
</code></pre></div>
<h2>Select</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.gql({select: &quot;`name!`, price-discount, upper(vendor)&quot;}, callback)
</code></pre></div>
<p>Select returns an object for each document in the database (unless limited by another clause).
Each of these objects will be populated with the properties specified in the select clause.
Arithmetic operators, aggregation functions, and scalar functions are all fair game.
Properties that are missing from an object in the database are assigned null.</p>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{name!: &quot;pencil&quot;, price: 2, discount: 0.7, vendor: &quot;store1&quot;},
{name!: &quot;pen&quot;, price:3, discount: 2, vendor: &quot;store2&quot;}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{name!: &quot;pen&quot;, price - discount: 1, upper(vendor): &quot;STORE2&quot;},
{name!: &quot;pencil&quot;, price - discount: 1.3, upper(vendor): &quot;STORE1&quot;}
</code></pre></div>
<h2>Where</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.gql({select: &quot;*&quot;, where: &quot;type=&#39;Fire&#39; and name is not null&quot;}, callback)
</code></pre></div>
<p>Where allows filtering of the objects that are passed to the select clause.  In this way, unwanted documents
can be excluded from the query result.  The where clause is composed of conditions which are joined by the
logical operators AND and OR.  An additional operator, NOT, provides negation.</p>

<p>Comparison operators can be used in conditions to perform comparisons.  The supported comparison operators are
&lt;=, &lt;, &gt;, &gt;=, !=, and &lt;&gt;.  != and &lt;&gt; are equivalent.  Null is treated slightly differently; to check if
something is null IS NULL is used.  To check if something is not null, IS NOT NULL is used.</p>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{name: &quot;charmander&quot;, type: &quot;Fire&quot;},
{type: &quot;Fire&quot;, attack:&quot;tail whip&quot;},
{name: &quot;charizard&quot;, type: &quot;Fire&quot;, attack:&quot;slash&quot;}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{_id: &quot;0D715E2C-CEDD-46B4-A060-9C9C290BEBE8&quot;, _rev: &quot;1-71d1e0f8ab00cf432306890a4116602b&quot;,
attack: &quot;slash&quot;, name: &quot;charizard&quot;, type: &quot;Fire&quot;},
{_id: &quot;3153F94B-0568-4D4C-BFA1-83EDF6185915&quot; _rev: &quot;1-d24f7405c5a63943391eaff9a260139c&quot;,
name: &quot;charmander&quot;, type: &quot;Fire&quot;}
</code></pre></div>
<p>Note the inclusion of the _rev and _id fields.  This is the result of using &#39;select *&#39; instead of naming the
desired fields explicitly.</p>

<h2>Group By</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.gql({select: &quot;max(charizard), charmeleon&quot;, groupBy: &quot;charmeleon&quot;}, callback)
</code></pre></div>
<p>Group by creates one object for each unique combination of values in the group by clause. For the query above,
if every document in the database had the value &quot;Level 22&quot; for the property &quot;charmeleon&quot;, only a single
object would be generated.</p>

<p>If a group by clause is present, every identifier in the select clause must either be the argument of an
aggregation function or present in the group by clause.  Otherwise, the composite objects formed by the group by
clause could have multiple values for some identifiers.</p>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{charizard: 50, charmander: 24, charmeleon: 2, haunter:true},
{charizard: 40, charmeleon: 2, charmander: 50},
{charizard: 7, charmeleon: 20, charmander: 15}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{charmeleon: 2, max(charizard): 50}
{charmeleon: 20, max(charizard): 7}
</code></pre></div>
<h2>Pivot</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text"> db.gql({select: &quot;max(charizard)&quot;, pivot: &quot;charmeleon&quot;}, callback)
</code></pre></div>
<p>Pivot is essentially group by for properties.  Each distinct value in the pivot clause gets its own property.
Unless used with group by, the result will have only a single document.</p>

<p>The same restriction for group by applies here; every identifier in the select clause must either be the
argument of an aggregation function or preset in the group by clause.  Additionally, identifiers in the pivot
clause may not be used in the group by clause.</p>

<p>Note that using pivot will generate novel property names.  See below for an example.</p>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{charizard: 50, charmeleon: &quot;hello&quot;},
{charizard: 40, charmeleon: &quot;hello&quot;},
{charizard: 7, charmeleon: &quot;world&quot;, charmander: 15}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{&#39;hello max(charizard)&#39;: 50, &#39;world max(charizard)&#39;: 7}
</code></pre></div>
<h2>Label</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text"> db.gql({select: &#39;upper(dept), charizard&#39;,
 label: &quot;upper(dept) &#39;Department&#39;, charizard &#39;Maximum Charizard!&#39;&quot;}, callback)
</code></pre></div>
<p>Label is used to transform cryptic identifiers into something that can be displayed directly to the end user.
Items in the label clause can be identifiers, aggregation functions, scalar functions, or operators.  The label
clause is composed of any number of statement label pairs, where the statement corresponds to some statement in
the select clause and the label is a string literal.</p>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{charizard: 50, dept: &quot;eng&quot;, lunch:&quot;2&quot;},
{charizard: 40, lunch: &quot;1&quot;, dept: &quot;market&quot;},·
{charizard: 99, dept: &quot;eng&quot;, lunch: 1},
{charizard: 7, dept: &quot;eng&quot;, lunch: 2}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{Department: &quot;ENG&quot;, Maximum Charizard!: 7},
{Department: &quot;ENG&quot;, Maximum Charizard!: 99},
{Department: &quot;MARKET&quot;, Maximum Charizard!: 40},
{Department: &quot;ENG&quot;, Maximum Charizard!: 50}
</code></pre></div>
<h2>Functions</h2>

<p>GQL contains a number of operators and functions that can operate on retrived documents.</p>

<h3>Aggregation Functions</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.gql({select: &quot;max(charizard), min(charizard), average(charizard), count(charizard), sum(charizard)&quot;},
callback)
</code></pre></div>
<p>The currently supported aggregation functions are avg, count, max, min, and sum.  Each of these takes a single
statement as an argument.  A statement can be composed of one or more identifiers joined by operators.
Avg and sum expect their arguments to evaluate to numbers; the other aggregators will accept any type of input.
Aggregation functions operate on entire identifiers, returning only a single property. Aggregation functions
may only appear in the select and label clauses.</p>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{charizard: 50},
{charizard: 40},
{charizard: 7}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{average(charizard): 32.333333333333336, count(charizard): 3, max(charizard): 50,
min(charizard): 7, sum(charizard): 97}
</code></pre></div>
<h3>Scalar Functions</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.gql({select: &quot;`name!`, price-discount, upper(vendor)&quot;}, callback)
</code></pre></div>
<p>Currently only two scalar functions are supported, upper and lower.  These change the characters in their inputs
to uppercase and lowercase respectively.  Unlike aggregator functions, scalar functions take only a single
identifier as their input.  Scalar functions may only appear in the select and label clauses.</p>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{name!: &quot;pencil&quot;, price: 2, discount: 0.7, vender: &quot;store1&quot;},
{name!: &quot;pen&quot;, price:3, discount: 2, vendor: &quot;store2&quot;}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{name!: &quot;pen&quot;, price - discount: 1, upper(vendor): &quot;STORE2&quot;},
{name!: &quot;pencil&quot;, price - discount: 1.3, upper(vendor): &quot;STORE1&quot;}
</code></pre></div>
<h3>Arithmetic Operators</h3>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.gql({select: &quot;*&quot;, where: &quot;charizard &lt;=charmander * charmeleon + 2 and (charmander - 7 !=  24/3)&quot;},
callback)
</code></pre></div>
<p>Arithmetic operators are used to perform basic math on the values from documents.  Their arguments must be
numbers.  Arithmetic operators may only appear in the select, label, and where clauses.  The arguments are
implicitly upcast to floats if necessary. The supported arithmetic operators are:</p>

<ul>
<li>Addition: &#39;+&#39;</li>
<li>Subtraction: &#39;-&#39;</li>
<li>Multiplication: &#39;*&#39;</li>
<li>Division: &#39;/&#39;</li>
</ul>

<p>With these documents in the database</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{charizard: 50, charmander: 24, charmeleon: 2, haunter:true},
{charizard: 40, charmeleon: .5, charmander: 50},
{charizard: 7, charmeleon: 20, charmander: 15}
</code></pre></div>
<p>The above query will return</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{charizard: 50, charmander: 24, charmeleon: 2, haunter: true}
</code></pre></div>
<h2>Miscellaneous</h2>

<p>Some features that are not covered in other sections.</p>

<h3>Literals</h3>

<p>Literals are used for comparison or arithmetic.  These are the supported literals:</p>

<ul>
<li>string: Any characters surrounded by single or double quotes</li>
<li>number: Numbers in regular decimal form.  They may have a single period, a single negative sign, and no commas</li>
<li>boolean: Either true or false</li>
</ul>

<h3>Identifiers</h3>

<p>Identifiers correspond to the properties of documents in the database.  There are strict rules governing the
way that identifiers can be expressed in queries.  If your identifier has spaces, is a reserved word, contains
any characters that are not letters or numbers or underscores, or starts with a digit, it must be surrounded
by backquotes (`identifier`).</p>

<h3>Reserved Words</h3>

<p>This is the current list of reserved words.  Because the GQL implementation is currently under development,
this list is likely to grow over time.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">and
asc
by
date
datetime
desc
false
format
group
label
limit
not
offset
options
or
order
pivot
select
timeofday
timestamp
true
where
</code></pre></div>
        <div>

    </div>

  </div>

</article>


    <div class="icons">

      <div class="container">

        <div class="row">

          <div class='col-xs-4 col-md-offset-0 col-md-2'>
            <a href='https://twitter.com/pouchdb' target='_blank'>
              <div class="icon icon-twitter"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='https://github.com/rvagg/node-levelup' target='_blank'>
              <div class="icon icon-leveldb"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='https://github.com/pouchdb/pouchdb' target='_blank'>
              <div class="icon icon-github"></div>
            </a>
            </div>

          <div class='col-xs-4 col-md-offset-0 col-md-2'>
            <a href='https://travis-ci.org/pouchdb/pouchdb' target='_blank'>
              <div class="icon icon-travis"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='http://couchdb.apache.org/' target='_blank'>
              <div class="icon icon-couchdb"></div>
            </a>
          </div>

          <div class='col-xs-4 col-md-2'>
            <a href='https://saucelabs.com' target='_blank'>
              <div class="icon icon-saucelabs"></div>
            </a>
          </div>

        </div>

      </div>

    </div>

    <footer class="footer">

      <div class="container">

        <div class="row">

          <div class='col-sm-3'>
            <h3 class="nav-head">Learn</h3>
            <ul class='nav nav-silent'>
              <li><a href="/getting-started.html">Getting Started</a></li>
              <li><a href="/api.html">API Guide</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb/wiki">Wiki</a></li>
            </ul>
          </div>

          <div class='col-sm-3'>
            <h3 class="nav-head">Discuss</h3>
            <ul class='nav nav-silent'>
              <li><a href="https://groups.google.com/forum/#!forum/pouchdb">Mailing List</a></li>
              <li><a href="irc://freenode.net/#pouchdb">IRC</a></li>
              <li><a href="http://twitter.com/pouchdb">Twitter</a></li>
              <li><a href="http://stackoverflow.com/questions/tagged/pouchdb">StackOverflow</a></li>
            </ul>
          </div>

          <div class='col-sm-3'>
            <h3 class="nav-head">Contribute</h3>
            <ul class='nav nav-silent'>
              <li><a href="https://github.com/pouchdb/pouchdb/blob/master/CONTRIBUTING.md">Contributing</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb">Source</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb/issues">Issues</a></li>
              <li><a href="https://github.com/pouchdb/pouchdb/blob/master/LICENSE">Apache License</a></li>
            </ul>
          </div>

        </div>

      </div>

    </footer>
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/js/code.min.js"></script>
    <script type="text/javascript" src="http://cdn.jsdelivr.net/pouchdb/latest/pouchdb.min.js"></script>
    <script type="text/javascript">
      function onCached(e) {
        if (applicationCache.status === 1) {
          giveIntro();
        }
      }
      
      function giveIntro() {
        console.log('%c\n..............................................................................\n.?I...........~+: ............................................................\n.???.........++++.............................................................\n:????+......+++++.............................................................\n.??????+++++++++:.................................H...........D..B............\n...????++++++++...................................H...........D..B............\n...=????++++++.......PPPPP...OOOO...U....U...CCCC.HHHHH...DDDDD..BBBBB........\n...?????+++++++......P...:P.OO...O..U....U..C.....H...H..D....D..B....B.......\n..???????+++++++ ....P. ..P.O....O..U....U.CC.....H...H..D....D..B....B.......\n..?????????????......P...:P.OO...O..U....U..C.....H...H..D....D..B....B.......\n...I??????????~......PPPPP...OOOO...=UUUUU...CCCC.H...H...DDDDD..BBBBB........\n....?????????~.......P.... ...................................................\n.....???????+........P........................................................\n......??????..................................................................\n..............................................................................\n..............................................................................\n..............................................................................', 'color: #4ec084');
        console.log('%c\nPouchDB itself is hosted at PouchDB.com!\nTo get started, try typing:\nvar db = new PouchDB(\'mydb\');', 'color: #4ec084');
      }
      applicationCache.addEventListener('cached', onCached, false);
      applicationCache.addEventListener('noupdate', giveIntro, false);
    </script>
  </body>
</html>
